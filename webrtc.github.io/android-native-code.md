<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>WebRTC Android development</title><link rel="stylesheet" type="text/css" href="/+static/base.css"/><link rel="stylesheet" type="text/css" href="/+static/doc.css"/><link rel="stylesheet" type="text/css" href="/+static/prettify/prettify.css"/><!-- default customHeadTagPart --></head><body class="Site"><header class="Site-header "><div class="Header"><div class="Header-title"></div></div></header><div class="Site-content Site-Content--markdown"><div class="Container"><div class="doc"><h1><a class="h" name="WebRTC-Android-development" href="#WebRTC-Android-development"><span></span></a><a class="h" name="webrtc-android-development" href="#webrtc-android-development"><span></span></a>WebRTC Android development</h1><h2><a class="h" name="Getting-the-Code" href="#Getting-the-Code"><span></span></a><a class="h" name="getting-the-code" href="#getting-the-code"><span></span></a>Getting the Code</h2><p>Android development is only supported on Linux.</p><ol><li><p>Install <a href="https://webrtc.googlesource.com/src/+/main/docs/native-code/development/prerequisite-sw/index.md">prerequisite software</a></p></li><li><p>Create a working directory, enter it, and run:</p></li></ol><pre class="code">$ fetch --nohooks webrtc_android
$ gclient sync
</pre><p>This will fetch a regular WebRTC checkout with the Android-specific parts added. Notice that the Android specific parts like the Android SDK and NDK are quite large (~8 GB), so the total checkout size will be about 16 GB. The same checkout can be used for both Linux and Android development since you can generate your <a href="https://ninja-build.org/">Ninja</a> project files in different directories for each build config.</p><p>See <a href="https://webrtc.googlesource.com/src/+/main/docs/native-code/development/index.md">Development</a> for instructions on how to update the code, building etc.</p><h2><a class="h" name="Compiling" href="#Compiling"><span></span></a><a class="h" name="compiling" href="#compiling"><span></span></a>Compiling</h2><ol><li>Generate projects using GN.</li></ol><p>Make sure your current working directory is src/ of your workspace. Then run:</p><pre class="code">$ gn gen out/Debug --args=&#39;target_os=&quot;android&quot; target_cpu=&quot;arm&quot;&#39;
</pre><p>You can specify a directory of your own choice instead of <code class="code">out/Debug</code>, to enable managing multiple configurations in parallel.</p><ul><li>To build for ARM64: use <code class="code">target_cpu=&quot;arm64&quot;</code></li><li>To build for 32-bit x86: use <code class="code">target_cpu=&quot;x86&quot;</code></li><li>To build for 64-bit x64: use <code class="code">target_cpu=&quot;x64&quot;</code></li></ul><ol start="2"><li>Compile using:</li></ol><pre class="code">$ autoninja -C out/Debug
</pre><p>(To list all available targets, run <code class="code">autoninja -C out/Debug -t targets all</code>.)</p><h2><a class="h" name="Using-the-Bundled-Android-SDK_NDK" href="#Using-the-Bundled-Android-SDK_NDK"><span></span></a><a class="h" name="using-the-bundled-android-sdk_ndk" href="#using-the-bundled-android-sdk_ndk"><span></span></a>Using the Bundled Android SDK/NDK</h2><p>In order to use the Android SDK and NDK that is bundled in <code class="code">third_party/android_tools</code>, run this to get it included in your <code class="code">PATH</code> (from <code class="code">src/</code>):</p><pre class="code">$ . build/android/envsetup.sh
</pre><p>Then you&#39;ll have <code class="code">adb</code> and all the other Android tools in your <code class="code">PATH</code>.</p><h2><a class="h" name="Running-the-AppRTCMobile-App" href="#Running-the-AppRTCMobile-App"><span></span></a><a class="h" name="running-the-apprtcmobile-app" href="#running-the-apprtcmobile-app"><span></span></a>Running the AppRTCMobile App</h2><p>AppRTCMobile is an Android application using WebRTC Native APIs via JNI (JNI wrapper is documented <a href="https://webrtc.googlesource.com/src/+/main/sdk/android/README">here</a>).</p><p>For instructions on how to build and run, see <a href="https://webrtc.googlesource.com/src/+/main/examples/androidapp/README">examples/androidapp/README</a>.</p><h2><a class="h" name="Using-Android-Studio" href="#Using-Android-Studio"><span></span></a><a class="h" name="using-android-studio" href="#using-android-studio"><span></span></a>Using Android Studio</h2><p><em>Note: This is known to be broken at the moment. See bug: <a href="https://bugs.webrtc.org/9282">https://bugs.webrtc.org/9282</a></em></p><ol><li>Build the project normally (out/Debug should be the directory you used when generating the build files using GN):</li></ol><pre class="code">$ autoninja -C out/Debug AppRTCMobile
</pre><ol start="2"><li>Generate the project files:</li></ol><pre class="code">$ build/android/gradle/generate_gradle.py --output-directory $PWD/out/Debug \
  --target &quot;//examples:AppRTCMobile&quot; --use-gradle-process-resources \
  --split-projects --canary
</pre><ol start="3"><li><p><em>Import</em> the project in Android Studio. (Do not just open it.) The project is located in <code class="code">out/Debug/gradle</code>. If asked which SDK to use, choose to use Android Studio&#39;s SDK. When asked whether to use the Gradle wrapper, press &ldquo;OK&rdquo;.</p></li><li><p>Ensure target <code class="code">webrtc &gt; examples &gt; AppRTCMobile</code> is selected and press Run. AppRTCMobile should now start on the device.</p></li></ol><p>If you do any changes to the C++ code, you have to compile the project using autoninja after the changes (see step 1).</p><p><em>Note: Only &ldquo;arm&rdquo; is supported as the target_cpu when using Android Studio. This still allows you to run the application on 64-bit ARM devices. x86-based devices are not supported right now.</em></p><h2><a class="h" name="Running-Tests-on-an-Android-Device" href="#Running-Tests-on-an-Android-Device"><span></span></a><a class="h" name="running-tests-on-an-android-device" href="#running-tests-on-an-android-device"><span></span></a>Running Tests on an Android Device</h2><p>To build APKs with the WebRTC native tests, follow these instructions.</p><ol><li><p>Ensure you have an Android device set in Developer mode connected via USB.</p></li><li><p>Compile unit tests and/or instrumentation tests:</p></li></ol><pre class="code">$ autoninja -C out/Debug android_instrumentation_test_apk
$ autoninja -C out/Debug rtc_unittests
</pre><ol start="3"><li>You can find the generated test binaries in <code class="code">out/Debug/bin</code>. To run instrumentation tests:</li></ol><pre class="code">$ out/Debug/bin/run_android_instrumentation_test_apk -v
</pre><p>To run unit tests:</p><pre class="code">$ out/Debug/bin/run_rtc_unittests -v
</pre><p>Show verbose output with <code class="code">-v</code> and filter tests with <code class="code">--gtest-filter=SomeTest.*</code>. For example:</p><pre class="code">$ out/Debug/bin/run_android_instrumentation_test_apk -v \
    --gtest_filter=VideoFrameBufferTest.*
</pre><p>For a full list of command line arguments, use <code class="code">--help</code>.</p><ol start="5"><li><strong>NOTICE:</strong> The first time you run a test, you must accept a dialog on the device!</li></ol><p>If want to run Release builds instead; pass <code class="code">is_debug=false</code> to GN (and preferably generate the projects files into a directory like <code class="code">out/Release</code>). Then use the scripts generated in <code class="code">out/Release/bin</code> instead.</p></div></div></div><!-- default customFooter --><footer class="Site-footer"><div class="Footer"><span class="Footer-poweredBy">Powered by <a href="https://gerrit.googlesource.com/gitiles/">Gitiles</a>| <a href="https://policies.google.com/privacy">Privacy</a></span><div class="Footer-links"></div></div></footer><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga('create', 'UA-55762617-15', 'auto'); ga('send', 'pageview', {title: 'WebRTC Android development'});</script><script async src="https://www.google-analytics.com/analytics.js"></script></body></html>