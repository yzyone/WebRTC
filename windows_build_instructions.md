<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Checking out and Building Chromium for Windows</title><link rel="stylesheet" type="text/css" href="/+static/base.css"/><link rel="stylesheet" type="text/css" href="/+static/doc.css"/><link rel="stylesheet" type="text/css" href="/+static/prettify/prettify.css"/><!-- default customHeadTagPart --></head><body class="Site"><header class="Site-header "><div class="Header"><div class="Header-title"></div></div></header><div class="Site-content Site-Content--markdown"><div class="Container"><div class="doc"><h1><a class="h" name="Checking-out-and-Building-Chromium-for-Windows" href="#Checking-out-and-Building-Chromium-for-Windows"><span></span></a><a class="h" name="checking-out-and-building-chromium-for-windows" href="#checking-out-and-building-chromium-for-windows"><span></span></a>Checking out and Building Chromium for Windows</h1><p>There are instructions for other platforms linked from the <a href="get_the_code.md">get the code</a> page.</p><h2><a class="h" name="Instructions-for-Google-Employees" href="#Instructions-for-Google-Employees"><span></span></a><a class="h" name="instructions-for-google-employees" href="#instructions-for-google-employees"><span></span></a>Instructions for Google Employees</h2><p>Are you a Google employee? See <a href="https://goto.google.com/building-chrome-win">go/building-chrome-win</a> instead.</p><div class="toc" role="navigation"><h2>Contents</h2><div class="toc-aux"><ul><li><a href="#Instructions-for-Google-Employees">Instructions for Google Employees</a></li><li><a href="#System-requirements">System requirements</a></li><li><a href="#Setting-up-Windows">Setting up Windows</a></li><ul><li><a href="#Visual-Studio">Visual Studio</a></li></ul><li><a href="#Install">Install</a></li><li><a href="#Check-python-install">Check python install</a></li><li><a href="#Get-the-code">Get the code</a></li><li><a href="#Setting-up-the-build">Setting up the build</a></li><ul><li><a href="#Faster-builds">Faster builds</a></li><li><a href="#Why-is-my-build-slow">Why is my build slow?</a></li></ul><li><a href="#Build-Chromium">Build Chromium</a></li><li><a href="#Run-Chromium">Run Chromium</a></li><li><a href="#Running-test-targets">Running test targets</a></li><li><a href="#Update-your-checkout">Update your checkout</a></li><ul><li><a href="#Editing-and-Debugging-With-the-Visual-Studio-IDE">Editing and Debugging With the Visual Studio IDE</a></li></ul></ul></div></div><h2><a class="h" name="System-requirements" href="#System-requirements"><span></span></a><a class="h" name="system-requirements" href="#system-requirements"><span></span></a>System requirements</h2><ul><li>A 64-bit Intel machine with at least 8GB of RAM. More than 16GB is highly recommended.</li><li>At least 100GB of free disk space on an NTFS-formatted hard drive. FAT32 will not work, as some of the Git packfiles are larger than 4GB.</li><li>An appropriate version of Visual Studio, as described below.</li><li>Windows 10 or newer.</li></ul><h2><a class="h" name="Setting-up-Windows" href="#Setting-up-Windows"><span></span></a><a class="h" name="setting-up-windows" href="#setting-up-windows"><span></span></a>Setting up Windows</h2><h3><a class="h" name="Visual-Studio" href="#Visual-Studio"><span></span></a><a class="h" name="visual-studio" href="#visual-studio"><span></span></a>Visual Studio</h3><p>Chromium requires <a href="https://docs.microsoft.com/en-us/visualstudio/releasenotes/vs2017-relnotes">Visual Studio 2017</a> (&gt;=15.7.2) to build, but <a href="https://docs.microsoft.com/en-us/visualstudio/releases/2019/release-notes">Visual Studio 2019</a> (&gt;=16.0.0) is preferred. Visual Studio can also be used to debug Chromium, and version 2019 is preferred for this as it handles Chromium&lsquo;s large debug information much better. The clang-cl compiler is used but Visual Studio&rsquo;s header files, libraries, and some tools are required. Visual Studio Community Edition should work if its license is appropriate for you. You must install the &ldquo;Desktop development with C++&rdquo; component and the &ldquo;MFC/ATL support&rdquo; sub-components. This can be done from the command line by passing these arguments to the Visual Studio installer (see below for ARM64 instructions):</p><pre class="code"><span class="pln">$ PATH_TO_INSTALLER</span><span class="pun">.</span><span class="pln">EXE </span><span class="pun">^</span><span class="pln">
</span><span class="pun">--</span><span class="pln">add </span><span class="typ">Microsoft</span><span class="pun">.</span><span class="typ">VisualStudio</span><span class="pun">.</span><span class="typ">Workload</span><span class="pun">.</span><span class="typ">NativeDesktop</span><span class="pln"> </span><span class="pun">^</span><span class="pln">
</span><span class="pun">--</span><span class="pln">add </span><span class="typ">Microsoft</span><span class="pun">.</span><span class="typ">VisualStudio</span><span class="pun">.</span><span class="typ">Component</span><span class="pun">.</span><span class="pln">VC</span><span class="pun">.</span><span class="pln">ATLMFC </span><span class="pun">^</span><span class="pln">
</span><span class="pun">--</span><span class="pln">includeRecommended
</span></pre><p>If you want to build for ARM64 Win32 then some extra arguments are needed. The full set for that case is:</p><pre class="code"><span class="pln">$ PATH_TO_INSTALLER</span><span class="pun">.</span><span class="pln">EXE </span><span class="pun">^</span><span class="pln">
</span><span class="pun">--</span><span class="pln">add </span><span class="typ">Microsoft</span><span class="pun">.</span><span class="typ">VisualStudio</span><span class="pun">.</span><span class="typ">Workload</span><span class="pun">.</span><span class="typ">NativeDesktop</span><span class="pln"> </span><span class="pun">^</span><span class="pln">
</span><span class="pun">--</span><span class="pln">add </span><span class="typ">Microsoft</span><span class="pun">.</span><span class="typ">VisualStudio</span><span class="pun">.</span><span class="typ">Component</span><span class="pun">.</span><span class="pln">VC</span><span class="pun">.</span><span class="pln">ATLMFC </span><span class="pun">^</span><span class="pln">
</span><span class="pun">--</span><span class="pln">add </span><span class="typ">Microsoft</span><span class="pun">.</span><span class="typ">VisualStudio</span><span class="pun">.</span><span class="typ">Component</span><span class="pun">.</span><span class="pln">VC</span><span class="pun">.</span><span class="typ">Tools</span><span class="pun">.</span><span class="pln">ARM64 </span><span class="pun">^</span><span class="pln">
</span><span class="pun">--</span><span class="pln">add </span><span class="typ">Microsoft</span><span class="pun">.</span><span class="typ">VisualStudio</span><span class="pun">.</span><span class="typ">Component</span><span class="pun">.</span><span class="pln">VC</span><span class="pun">.</span><span class="pln">MFC</span><span class="pun">.</span><span class="pln">ARM64 </span><span class="pun">^</span><span class="pln">
</span><span class="pun">--</span><span class="pln">includeRecommended
</span></pre><p>-You must have the version 10.0.19041 or higher <a href="https://developer.microsoft.com/en-us/windows/downloads/sdk-archive/">Windows 10 SDK</a> installed. This can be installed separately or by checking the appropriate box in the Visual Studio Installer.</p><p>The SDK Debugging Tools must also be installed. If the Windows 10 SDK was installed via the Visual Studio installer, then they can be installed by going to: Control Panel → Programs → Programs and Features → Select the &ldquo;Windows Software Development Kit&rdquo; → Change → Change → Check &ldquo;Debugging Tools For Windows&rdquo; → Change. Or, you can download the standalone SDK installer and use it to install the Debugging Tools.</p><h2><a class="h" name="Install" href="#Install"><span></span></a><a class="h" name="install" href="#install"><span></span></a>Install <code class="code">depot_tools</code></h2><p>Download the <a href="https://storage.googleapis.com/chrome-infra/depot_tools.zip">depot_tools bundle</a> and extract it somewhere.</p><div class="note"><strong>Warning:</strong> <strong>DO NOT</strong> use drag-n-drop or copy-n-paste extract from Explorer, this will not extract the hidden “.git” folder which is necessary for depot_tools to autoupdate itself. You can use “Extract all…” from the context menu though.</div><p>Add depot_tools to the start of your PATH (must be ahead of any installs of Python). Assuming you unzipped the bundle to C:\src\depot_tools, open:</p><p>Control Panel → System and Security → System → Advanced system settings</p><p>If you have Administrator access, Modify the PATH system variable and put <code class="code">C:\src\depot_tools</code> at the front (or at least in front of any directory that might already have a copy of Python or Git).</p><p>If you don&#39;t have Administrator access, you can add a user-level PATH environment variable and put <code class="code">C:\src\depot_tools</code> at the front, but if your system PATH has a Python in it, you will be out of luck.</p><p>Also, add a DEPOT_TOOLS_WIN_TOOLCHAIN system variable in the same way, and set it to 0. This tells depot_tools to use your locally installed version of Visual Studio (by default, depot_tools will try to use a google-internal version).</p><p>You may also have to set variable <code class="code">vs2017_install</code> or <code class="code">vs2019_install</code> or <code class="code">vs2022_install</code> to your installation path of Visual Studio 2017 or 19 or 22, like <code class="code">set vs2019_install=C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional</code> for Visual Studio 2019, or <code class="code">set vs2022_install=C:\Program Files\Microsoft Visual Studio\2022\Professional</code> for Visual Studio 2022.</p><p>From a cmd.exe shell, run:</p><pre class="code"><span class="pln">$ gclient
</span></pre><p>On first run, gclient will install all the Windows-specific bits needed to work with the code, including msysgit and python.</p><ul><li>If you run gclient from a non-cmd shell (e.g., cygwin, PowerShell), it may appear to run properly, but msysgit, python, and other tools may not get installed correctly.</li><li>If you see strange errors with the file system on the first run of gclient, you may want to <a href="http://tortoisesvn.tigris.org/faq.html#cantmove2">disable Windows Indexing</a>.</li></ul><h2><a class="h" name="Check-python-install" href="#Check-python-install"><span></span></a><a class="h" name="check-python-install" href="#check-python-install"><span></span></a>Check python install</h2><p>After running gclient open a command prompt and type <code class="code">where python</code> and confirm that the depot_tools <code class="code">python.bat</code> comes ahead of any copies of python.exe. Failing to ensure this can lead to overbuilding when using gn - see <a href="https://crbug.com/611087">crbug.com/611087</a>.</p><p><a href="https://docs.microsoft.com/en-us/windows/apps/desktop/modernize/desktop-to-uwp-extensions#alias">App Execution Aliases</a> can conflict with other installations of python on the system so disable these for &lsquo;python.exe&rsquo; and &lsquo;python3.exe&rsquo; by opening &lsquo;App execution aliases&rsquo; section of Control Panel and unticking the boxes next to both of these that point to &lsquo;App Installer&rsquo;.</p><h2><a class="h" name="Get-the-code" href="#Get-the-code"><span></span></a><a class="h" name="get-the-code" href="#get-the-code"><span></span></a>Get the code</h2><p>First, configure Git:</p><pre class="code"><span class="pln">$ git config </span><span class="pun">--</span><span class="kwd">global</span><span class="pln"> user</span><span class="pun">.</span><span class="pln">name </span><span class="str">&quot;My Name&quot;</span><span class="pln">
$ git config </span><span class="pun">--</span><span class="kwd">global</span><span class="pln"> user</span><span class="pun">.</span><span class="pln">email </span><span class="str">&quot;my-name@chromium.org&quot;</span><span class="pln">
$ git config </span><span class="pun">--</span><span class="kwd">global</span><span class="pln"> core</span><span class="pun">.</span><span class="pln">autocrlf </span><span class="kwd">false</span><span class="pln">
$ git config </span><span class="pun">--</span><span class="kwd">global</span><span class="pln"> core</span><span class="pun">.</span><span class="pln">filemode </span><span class="kwd">false</span><span class="pln">
$ git config </span><span class="pun">--</span><span class="kwd">global</span><span class="pln"> branch</span><span class="pun">.</span><span class="pln">autosetuprebase always
</span></pre><p>Create a <code class="code">chromium</code> directory for the checkout and change to it (you can call this whatever you like and put it wherever you like, as long as the full path has no spaces):</p><pre class="code"><span class="pln">$ mkdir chromium </span><span class="pun">&amp;&amp;</span><span class="pln"> cd chromium
</span></pre><p>Run the <code class="code">fetch</code> tool from <code class="code">depot_tools</code> to check out the code and its dependencies.</p><pre class="code"><span class="pln">$ fetch chromium
</span></pre><p>If you don&#39;t want the full repo history, you can save a lot of time by adding the <code class="code">--no-history</code> flag to <code class="code">fetch</code>.</p><p>Expect the command to take 30 minutes on even a fast connection, and many hours on slower ones.</p><p>When <code class="code">fetch</code> completes, it will have created a hidden <code class="code">.gclient</code> file and a directory called <code class="code">src</code> in the working directory. The remaining instructions assume you have switched to the <code class="code">src</code> directory:</p><pre class="code"><span class="pln">$ cd src
</span></pre><p><em>Optional</em>: You can also <a href="https://www.chromium.org/developers/how-tos/api-keys">install API keys</a> if you want your build to talk to some Google services, but this is not necessary for most development and testing purposes.</p><h2><a class="h" name="Setting-up-the-build" href="#Setting-up-the-build"><span></span></a><a class="h" name="setting-up-the-build" href="#setting-up-the-build"><span></span></a>Setting up the build</h2><p>Chromium uses <a href="https://ninja-build.org">Ninja</a> as its main build tool along with a tool called <a href="https://gn.googlesource.com/gn/+/main/docs/quick_start.md">GN</a> to generate <code class="code">.ninja</code> files. You can create any number of <em>build directories</em> with different configurations. To create a build directory:</p><pre class="code"><span class="pln">$ gn gen </span><span class="kwd">out</span><span class="pun">/</span><span class="typ">Default</span><span class="pln">
</span></pre><ul><li>You only have to run this once for each new build directory, Ninja will update the build files as needed.</li><li>You can replace <code class="code">Default</code> with another name, but it should be a subdirectory of <code class="code">out</code>.</li><li>For other build arguments, including release settings or using an alternate version of Visual Studio, see <a href="https://www.chromium.org/developers/gn-build-configuration">GN build configuration</a>. The default will be a debug component build matching the current host operating system and CPU.</li><li>For more info on GN, run <code class="code">gn help</code> on the command line or read the <a href="https://gn.googlesource.com/gn/+/main/docs/quick_start.md">quick start guide</a>.</li></ul><h3><a class="h" name="Faster-builds" href="#Faster-builds"><span></span></a><a class="h" name="faster-builds" href="#faster-builds"><span></span></a>Faster builds</h3><ul><li>Reduce file system overhead by excluding build directories from antivirus and indexing software.</li><li>Store the build tree on a fast disk (preferably SSD).</li><li>The more cores the better (20+ is not excessive) and lots of RAM is needed (64 GB is not excessive).</li></ul><p>There are some gn flags that can improve build speeds. You can specify these in the editor that appears when you create your output directory (<code class="code">gn args out/Default</code>) or on the gn gen command line (<code class="code">gn gen out/Default --args=&quot;is_component_build = true is_debug = true&quot;</code>). Some helpful settings to consider using include:</p><ul><li><code class="code">is_component_build = true</code> - this uses more, smaller DLLs, and incremental linking.</li><li><code class="code">enable_nacl = false</code> - this disables Native Client which is usually not needed for local builds.</li><li><code class="code">target_cpu = &quot;x86&quot;</code> - x86 builds are slightly faster than x64 builds and support incremental linking for more targets. Note that if you set this but don&lsquo;t&rsquo; set enable_nacl = false then build times may get worse.</li><li><code class="code">blink_symbol_level = 0</code> - turn off source-level debugging for blink to reduce build times, appropriate if you don&#39;t plan to debug blink.</li><li><code class="code">v8_symbol_level = 0</code> - turn off source-level debugging for v8 to reduce build times, appropriate if you don&#39;t plan to debug v8.</li></ul><p>In order to speed up linking you can set <code class="code">symbol_level = 1</code> or <code class="code">symbol_level = 0</code> - these options reduce the work the compiler and linker have to do. With <code class="code">symbol_level = 1</code> the compiler emits file name and line number information so you can still do source-level debugging but there will be no local variable or type information. With <code class="code">symbol_level = 0</code> there is no source-level debugging but call stacks still have function names. Changing <code class="code">symbol_level</code> requires recompiling everything.</p><p>In addition, Google employees should use goma, a distributed compilation system. Detailed information is available internally but the relevant gn arg is:</p><ul><li><code class="code">use_goma = true</code></li></ul><p>To get any benefit from goma it is important to pass a large -j value to ninja. A good default is 10*numCores to 20*numCores. If you run autoninja then it will automatically pass an appropriate -j value to ninja for goma or not.</p><pre class="code"><span class="pln">$ autoninja </span><span class="pun">-</span><span class="pln">C </span><span class="kwd">out</span><span class="pln">\Default chrome
</span></pre><p>When invoking ninja specify &lsquo;chrome&rsquo; as the target to avoid building all test binaries as well.</p><p>Still, builds will take many hours on many machines.</p><h4><a class="h" name="Use-SCCACHE" href="#Use-SCCACHE"><span></span></a><a class="h" name="use-sccache" href="#use-sccache"><span></span></a>Use SCCACHE</h4><p>You might be able to use <a href="https://github.com/mozilla/sccache">sccache</a> for the build process by enabling the following arguments:</p><ul><li><code class="code">cc_wrapper = &quot;sccache&quot;</code> - assuming the <code class="code">sccache</code> binary is in your <code class="code">%PATH%</code></li><li><code class="code">chrome_pgo_phase = 0</code></li></ul><h3><a class="h" name="Why-is-my-build-slow" href="#Why-is-my-build-slow"><span></span></a><a class="h" name="why-is-my-build-slow" href="#why-is-my-build-slow"><span></span></a>Why is my build slow?</h3><p>Many things can make builds slow, with Windows Defender slowing process startups being a frequent culprit. Have you ensured that the entire Chromium src directory is excluded from antivirus scanning (on Google machines this means putting it in a <code class="code">src</code> directory in the root of a drive)? Have you tried the different settings listed above, including different link settings and -j values? Have you asked on the chromium-dev mailing list to see if your build is slower than expected for your machine&#39;s specifications?</p><p>The next step is to gather some data. If you set the <code class="code">NINJA_SUMMARIZE_BUILD</code> environment variable to 1 then <code class="code">autoninja</code> will do three things. First, it will set the <a href="https://ninja-build.org/manual.html#_environment_variables">NINJA_STATUS</a> environment variable so that ninja will print additional information while building Chrome. It will show how many build processes are running at any given time, how many build steps have completed, how many build steps have completed per second, and how long the build has been running, as shown here:</p><pre class="code"><span class="pln">$ </span><span class="kwd">set</span><span class="pln"> NINJA_SUMMARIZE_BUILD</span><span class="pun">=</span><span class="lit">1</span><span class="pln">
$ autoninja </span><span class="pun">-</span><span class="pln">C </span><span class="kwd">out</span><span class="pln">\Default </span><span class="kwd">base</span><span class="pln">
ninja</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Entering</span><span class="pln"> directory </span><span class="str">`out\Default&#39;
[1 processes, 86/86 @ 2.7/s : 31.785s ] LINK(DLL) base.dll base.dll.lib base.dll.pdb
</span></pre><p>This makes slow process creation immediately obvious and lets you tell quickly if a build is running more slowly than normal.</p><p>In addition, setting <code class="code">NINJA_SUMMARIZE_BUILD=1</code> tells <code class="code">autoninja</code> to print a build performance summary when the build completes, showing the slowest build steps and slowest build-step types, as shown here:</p><pre class="code"><span class="pln">$ </span><span class="kwd">set</span><span class="pln"> NINJA_SUMMARIZE_BUILD</span><span class="pun">=</span><span class="lit">1</span><span class="pln">
$ autoninja </span><span class="pun">-</span><span class="pln">C </span><span class="kwd">out</span><span class="pln">\Default </span><span class="kwd">base</span><span class="pln">
</span><span class="typ">Longest</span><span class="pln"> build steps</span><span class="pun">:</span><span class="pln">
       </span><span class="lit">0.1</span><span class="pln"> weighted s to build obj</span><span class="pun">/</span><span class="kwd">base</span><span class="pun">/</span><span class="kwd">base</span><span class="pun">/</span><span class="pln">trace_log</span><span class="pun">.</span><span class="pln">obj </span><span class="pun">(</span><span class="lit">6.7</span><span class="pln"> s elapsed time</span><span class="pun">)</span><span class="pln">
       </span><span class="lit">0.2</span><span class="pln"> weighted s to build nasm</span><span class="pun">.</span><span class="pln">exe</span><span class="pun">,</span><span class="pln"> nasm</span><span class="pun">.</span><span class="pln">exe</span><span class="pun">.</span><span class="pln">pdb </span><span class="pun">(</span><span class="lit">0.2</span><span class="pln"> s elapsed time</span><span class="pun">)</span><span class="pln">
       </span><span class="lit">0.3</span><span class="pln"> weighted s to build obj</span><span class="pun">/</span><span class="kwd">base</span><span class="pun">/</span><span class="kwd">base</span><span class="pun">/</span><span class="pln">win_util</span><span class="pun">.</span><span class="pln">obj </span><span class="pun">(</span><span class="lit">12.4</span><span class="pln"> s elapsed time</span><span class="pun">)</span><span class="pln">
       </span><span class="lit">1.2</span><span class="pln"> weighted s to build </span><span class="kwd">base</span><span class="pun">.</span><span class="pln">dll</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">base</span><span class="pun">.</span><span class="pln">dll</span><span class="pun">.</span><span class="pln">lib </span><span class="pun">(</span><span class="lit">1.2</span><span class="pln"> s elapsed time</span><span class="pun">)</span><span class="pln">
</span><span class="typ">Time</span><span class="pln"> </span><span class="kwd">by</span><span class="pln"> build</span><span class="pun">-</span><span class="pln">step type</span><span class="pun">:</span><span class="pln">
       </span><span class="lit">0.0</span><span class="pln"> s weighted time to generate </span><span class="lit">6</span><span class="pln"> </span><span class="pun">.</span><span class="pln">lib files </span><span class="pun">(</span><span class="lit">0.3</span><span class="pln"> s elapsed time sum</span><span class="pun">)</span><span class="pln">
       </span><span class="lit">0.1</span><span class="pln"> s weighted time to generate </span><span class="lit">25</span><span class="pln"> </span><span class="pun">.</span><span class="pln">stamp files </span><span class="pun">(</span><span class="lit">1.2</span><span class="pln"> s elapsed time sum</span><span class="pun">)</span><span class="pln">
       </span><span class="lit">0.2</span><span class="pln"> s weighted time to generate </span><span class="lit">20</span><span class="pln"> </span><span class="pun">.</span><span class="pln">o files </span><span class="pun">(</span><span class="lit">2.8</span><span class="pln"> s elapsed time sum</span><span class="pun">)</span><span class="pln">
       </span><span class="lit">1.7</span><span class="pln"> s weighted time to generate </span><span class="lit">4</span><span class="pln"> </span><span class="typ">PEFile</span><span class="pln"> </span><span class="pun">(</span><span class="pln">linking</span><span class="pun">)</span><span class="pln"> files </span><span class="pun">(</span><span class="lit">2.0</span><span class="pln"> s elapsed
time sum</span><span class="pun">)</span><span class="pln">
      </span><span class="lit">23.9</span><span class="pln"> s weighted time to generate </span><span class="lit">770</span><span class="pln"> </span><span class="pun">.</span><span class="pln">obj files </span><span class="pun">(</span><span class="lit">974.8</span><span class="pln"> s elapsed time sum</span><span class="pun">)</span><span class="pln">
</span><span class="lit">26.1</span><span class="pln"> s weighted time </span><span class="pun">(</span><span class="lit">982.9</span><span class="pln"> s elapsed time sum</span><span class="pun">,</span><span class="pln"> </span><span class="lit">37.7x</span><span class="pln"> parallelism</span><span class="pun">)</span><span class="pln">
</span><span class="lit">839</span><span class="pln"> build steps completed</span><span class="pun">,</span><span class="pln"> average of </span><span class="lit">32.17</span><span class="pun">/</span><span class="pln">s
</span></pre><p>The &ldquo;weighted&rdquo; time is the elapsed time of each build step divided by the number of tasks that were running in parallel. This makes it an excellent approximation of how &ldquo;important&rdquo; a slow step was. A link that is entirely or mostly serialized will have a weighted time that is the same or similar to its elapsed time. A compile that runs in parallel with 999 other compiles will have a weighted time that is tiny.</p><p>You can also generate these reports by manually running the script after a build:</p><pre class="code"><span class="pln">$ python depot_tools\post_build_ninja_summary</span><span class="pun">.</span><span class="pln">py </span><span class="pun">-</span><span class="pln">C </span><span class="kwd">out</span><span class="pln">\Default
</span></pre><p>Finally, setting <code class="code">NINJA_SUMMARIZE_BUILD=1</code> tells autoninja to tell Ninja to report on its own overhead by passing &ldquo;-d stats&rdquo;. This can be helpful if, for instance, process creation (which shows up in the StartEdge metric) is making builds slow, perhaps due to antivirus interference due to clang-cl not being in an excluded directory:</p><pre class="code"><span class="pln">$ </span><span class="kwd">set</span><span class="pln"> NINJA_SUMMARIZE_BUILD</span><span class="pun">=</span><span class="lit">1</span><span class="pln">
$ autoninja </span><span class="pun">-</span><span class="pln">C </span><span class="kwd">out</span><span class="pln">\Default </span><span class="kwd">base</span><span class="pln">
</span><span class="str">&quot;c:\src\depot_tools\ninja.exe&quot;</span><span class="pln"> </span><span class="pun">-</span><span class="pln">C </span><span class="kwd">out</span><span class="pln">\Default </span><span class="kwd">base</span><span class="pln"> </span><span class="pun">-</span><span class="pln">j </span><span class="lit">10</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d stats
metric                  count   avg </span><span class="pun">(</span><span class="pln">us</span><span class="pun">)</span><span class="pln">        total </span><span class="pun">(</span><span class="pln">ms</span><span class="pun">)</span><span class="pln">
</span><span class="pun">.</span><span class="pln">ninja parse            </span><span class="lit">3555</span><span class="pln">    </span><span class="lit">1539.4</span><span class="pln">          </span><span class="lit">5472.6</span><span class="pln">
canonicalize str        </span><span class="lit">1383032</span><span class="pln"> </span><span class="lit">0.0</span><span class="pln">             </span><span class="lit">12.7</span><span class="pln">
canonicalize path       </span><span class="lit">1402349</span><span class="pln"> </span><span class="lit">0.0</span><span class="pln">             </span><span class="lit">11.2</span><span class="pln">
lookup node             </span><span class="lit">1398245</span><span class="pln"> </span><span class="lit">0.0</span><span class="pln">             </span><span class="lit">8.1</span><span class="pln">
</span><span class="pun">.</span><span class="pln">ninja_log load         </span><span class="lit">2</span><span class="pln">       </span><span class="lit">118.0</span><span class="pln">           </span><span class="lit">0.2</span><span class="pln">
</span><span class="pun">.</span><span class="pln">ninja_deps load        </span><span class="lit">2</span><span class="pln">       </span><span class="lit">67.5</span><span class="pln">            </span><span class="lit">0.1</span><span class="pln">
node stat               </span><span class="lit">2516</span><span class="pln">    </span><span class="lit">29.6</span><span class="pln">            </span><span class="lit">74.4</span><span class="pln">
depfile load            </span><span class="lit">2</span><span class="pln">       </span><span class="lit">1132.0</span><span class="pln">          </span><span class="lit">2.3</span><span class="pln">
</span><span class="typ">StartEdge</span><span class="pln">               </span><span class="lit">88</span><span class="pln">      </span><span class="lit">3508.1</span><span class="pln">          </span><span class="lit">308.7</span><span class="pln">
</span><span class="typ">FinishCommand</span><span class="pln">           </span><span class="lit">87</span><span class="pln">      </span><span class="lit">1670.9</span><span class="pln">          </span><span class="lit">145.4</span><span class="pln">
</span><span class="typ">CLParser</span><span class="pun">::</span><span class="typ">Parse</span><span class="pln">         </span><span class="lit">45</span><span class="pln">      </span><span class="lit">1889.1</span><span class="pln">          </span><span class="lit">85.0</span><span class="pln">
</span></pre><p>You can also get a visual report of the build performance with <a href="https://github.com/nico/ninjatracing">ninjatracing</a>. This converts the .ninja_log file into a .json file which can be loaded into <a href="chrome%3A//tracing">chrome://tracing</a>:</p><pre class="code"><span class="pln">$ python ninjatracing </span><span class="kwd">out</span><span class="pln">\Default\.ninja_log </span><span class="pun">&gt;</span><span class="pln">build</span><span class="pun">.</span><span class="pln">json
</span></pre><h2><a class="h" name="Build-Chromium" href="#Build-Chromium"><span></span></a><a class="h" name="build-chromium" href="#build-chromium"><span></span></a>Build Chromium</h2><p>Build Chromium (the &ldquo;chrome&rdquo; target) with Ninja using the command:</p><pre class="code"><span class="pln">$ autoninja </span><span class="pun">-</span><span class="pln">C </span><span class="kwd">out</span><span class="pln">\Default chrome
</span></pre><p><code class="code">autoninja</code> is a wrapper that automatically provides optimal values for the arguments passed to <code class="code">ninja</code>.</p><p>You can get a list of all of the other build targets from GN by running <code class="code">gn ls out/Default</code> from the command line. To compile one, pass to Ninja the GN label with no preceding &ldquo;//&rdquo; (so for <code class="code">//chrome/test:unit_tests</code> use ninja -C out/Default chrome/test:unit_tests`).</p><h2><a class="h" name="Run-Chromium" href="#Run-Chromium"><span></span></a><a class="h" name="run-chromium" href="#run-chromium"><span></span></a>Run Chromium</h2><p>Once it is built, you can simply run the browser:</p><pre class="code"><span class="pln">$ </span><span class="kwd">out</span><span class="pln">\Default\chrome</span><span class="pun">.</span><span class="pln">exe
</span></pre><p>(The &ldquo;.exe&rdquo; suffix in the command is actually optional).</p><h2><a class="h" name="Running-test-targets" href="#Running-test-targets"><span></span></a><a class="h" name="running-test-targets" href="#running-test-targets"><span></span></a>Running test targets</h2><p>You can run the tests in the same way. You can also limit which tests are run using the <code class="code">--gtest_filter</code> arg, e.g.:</p><pre class="code"><span class="pln">$ </span><span class="kwd">out</span><span class="pln">\Default\unit_tests</span><span class="pun">.</span><span class="pln">exe </span><span class="pun">--</span><span class="pln">gtest_filter</span><span class="pun">=</span><span class="str">&quot;PushClientTest.*&quot;</span><span class="pln">
</span></pre><p>You can find out more about GoogleTest at its <a href="https://github.com/google/googletest">GitHub page</a>.</p><h2><a class="h" name="Update-your-checkout" href="#Update-your-checkout"><span></span></a><a class="h" name="update-your-checkout" href="#update-your-checkout"><span></span></a>Update your checkout</h2><p>To update an existing checkout, you can run</p><pre class="code"><span class="pln">$ git rebase</span><span class="pun">-</span><span class="pln">update
$ gclient sync </span><span class="pun">-</span><span class="pln">D
</span></pre><p>The first command updates the primary Chromium source repository and rebases any of your local branches on top of tip-of-tree (aka the Git branch <code class="code">origin/main</code>). If you don&#39;t want to use this script, you can also just use <code class="code">git pull</code> or other common Git commands to update the repo.</p><p>The second command syncs the subrepositories to the appropriate versions, deleting those that are no longer needed, and re-runs the hooks as needed.</p><h3><a class="h" name="Editing-and-Debugging-With-the-Visual-Studio-IDE" href="#Editing-and-Debugging-With-the-Visual-Studio-IDE"><span></span></a><a class="h" name="editing-and-debugging-with-the-visual-studio-ide" href="#editing-and-debugging-with-the-visual-studio-ide"><span></span></a>Editing and Debugging With the Visual Studio IDE</h3><p>You can use the Visual Studio IDE to edit and debug Chrome, with or without Intellisense support.</p><h4><a class="h" name="Using-Visual-Studio-Intellisense" href="#Using-Visual-Studio-Intellisense"><span></span></a><a class="h" name="using-visual-studio-intellisense" href="#using-visual-studio-intellisense"><span></span></a>Using Visual Studio Intellisense</h4><p>If you want to use Visual Studio Intellisense when developing Chromium, use the <code class="code">--ide</code> command line argument to <code class="code">gn gen</code> when you generate your output directory (as described on the <a href="https://dev.chromium.org/developers/how-tos/get-the-code">get the code</a> page):</p><pre class="code"><span class="pln">$ gn gen </span><span class="pun">--</span><span class="pln">ide</span><span class="pun">=</span><span class="pln">vs </span><span class="kwd">out</span><span class="pln">\Default
$ devenv </span><span class="kwd">out</span><span class="pln">\Default\all</span><span class="pun">.</span><span class="pln">sln
</span></pre><p>GN will produce a file <code class="code">all.sln</code> in your build directory. It will internally use Ninja to compile while still allowing most IDE functions to work (there is no native Visual Studio compilation mode). If you manually run &ldquo;gen&rdquo; again you will need to resupply this argument, but normally GN will keep the build and IDE files up to date automatically when you build.</p><p>The generated solution will contain several thousand projects and will be very slow to load. Use the <code class="code">--filters</code> argument to restrict generating project files for only the code you&#39;re interested in. Although this will also limit what files appear in the project explorer, debugging will still work and you can set breakpoints in files that you open manually. A minimal solution that will let you compile and run Chrome in the IDE but will not show any source files is:</p><pre class="code">$ gn gen --ide=vs --filters=//chrome --no-deps out\Default
</pre><p>You can selectively add other directories you care about to the filter like so: <code class="code">--filters=//chrome;//third_party/WebKit/*;//gpu/*</code>.</p><p>There are other options for controlling how the solution is generated, run <code class="code">gn help gen</code> for the current documentation.</p><h4><a class="h" name="Using-Visual-Studio-without-Intellisense" href="#Using-Visual-Studio-without-Intellisense"><span></span></a><a class="h" name="using-visual-studio-without-intellisense" href="#using-visual-studio-without-intellisense"><span></span></a>Using Visual Studio without Intellisense</h4><p>It is also possible to debug and develop Chrome in Visual Studio without the overhead of a multi-project solution file. Simply &ldquo;open&rdquo; your chrome.exe binary with <code class="code">File-&gt;Open-&gt;Project/Solution</code>, or from a Visual Studio command prompt like so: <code class="code">devenv /debugexe out\Debug\chrome.exe &lt;your arguments&gt;</code>. Many of Visual Studio&#39;s code exploration features will not work in this configuration, but by installing the <a href="https://chromium.github.io/vs-chromium/">VsChromium Visual Studio Extension</a> you can get the source code to appear in the solution explorer window along with other useful features such as code search. You can add multiple executables of interest (base_unittests.exe, browser_tests.exe) to your solution with <code class="code">File-&gt;Add-&gt;Existing Project...</code> and change which one will be debugged by right-clicking on them in <code class="code">Solution Explorer</code> and selecting <code class="code">Set as Startup Project</code>. You can also change their properties, including command line arguments, by right-clicking on them in <code class="code">Solution Explorer</code> and selecting <code class="code">Properties</code>.</p><p>By default when you start debugging in Visual Studio the debugger will only attach to the main browser process. To debug all of Chrome, install <a href="https://blogs.msdn.microsoft.com/devops/2014/11/24/introducing-the-child-process-debugging-power-tool/">Microsoft&#39;s Child Process Debugging Power Tool</a>. You will also need to run Visual Studio as administrator, or it will silently fail to attach to some of Chrome&#39;s child processes.</p></div></div></div><!-- default customFooter --><footer class="Site-footer"><div class="Footer"><span class="Footer-poweredBy">Powered by <a href="https://gerrit.googlesource.com/gitiles/">Gitiles</a>| <a href="https://policies.google.com/privacy">Privacy</a></span><div class="Footer-links"></div></div></footer><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga('create', 'UA-55762617-15', 'auto'); ga('send', 'pageview', {title: 'Checking out and Building Chromium for Windows'});</script><script async src="https://www.google-analytics.com/analytics.js"></script></body></html>